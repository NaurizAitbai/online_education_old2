{% extends 'base/base.html' %}

{% load static %}
{% load i18n %}

{% block css %}
<link rel="stylesheet" href="{% static 'xterm/css/xterm.css' %}">
<link rel="stylesheet" href="{% static 'codemirror/lib/codemirror.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center mt-5">
        {% trans "Курс" %}: {{ lesson.course }}
    </h1>
    <h2 class="text-center">
        {% trans "Урок" %}: {{ lesson.name }}
    </h2>
    <div class="mt-3">
        {{ lesson.lesson_text }}
    </div>
    <div class="mt-3">
        <div class="border">
            <textarea name="user_code" id="editor">{% if lesson_progress and lesson_progress.current_code %}{{ lesson_progress.current_code }}{% else %}{% if lesson.original_code %}{{ lesson.original_code }}{% endif %}{% endif %}</textarea>
        </div>
        <div class="text-right mt-1">
            <button id="runCode" class="btn btn-primary btn-sm">Выполнить код</button>
            <button id="checkCode" class="btn btn-success btn-sm">Отправить на проверку</button>
        </div>
    </div>
    <div class="mt-3 mb-5">
        <div id="terminalMessage"></div>
        <div id="terminal"></div>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
    const lesson = {
        id: {{ lesson.id }}
    }
</script>
<script src="{% static 'xterm/lib/xterm.js' %}"></script>
<script src="{% static 'xterm-addon-attach/lib/xterm-addon-attach.js' %}"></script>
<script src="{% static 'xterm-addon-fit/lib/xterm-addon-fit.js' %}"></script>
<script src="{% static 'codemirror/lib/codemirror.js' %}"></script>
<script src="{% static 'codemirror/mode/python/python.js' %}"></script>
<script src="{% static 'base/lesson.js' %}"></script>
{% endblock %}